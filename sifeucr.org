#+title: SIFEUCR

* API

** Generador de documentos

Genera los documentos para previsualizar, y también para descargar en caso de
que se requiera solicitar manualmente por correo.

*** Endpoint

#+begin_src
/api/docs/[servicios/suministros/bienes]
#+end_src

*** Permisos

*** Respuesta

#+begin_src json
{
  "docs": [
    {
      "tipo": "proforma",
      "doc": "base64pdf"
    },
    {
      "tipo": "justificacion",
      "doc": "base64pdf"
    }
  ]
}
#+end_src

** Registrar solicitud

Si todos los requerimientos se cumplen, se registra la solicitud y devuelve el
ID indicando que se registró correctamente.

1. Se validan los datos que se adjuntan para la solicitud
2. Se envía automáticamente al correo finanzas.feucr@ucr.ac.cr deade el correo de la persona de la asociación acreditada
3. Se registra en la base de datos
4. Queda pendiente de aprobación de SF, COES, GECO

*** Endpoint

#+begin_src
/api/solicitar/[servicios/suministros/bienes]
#+end_src

*** Permisos

- La entidad ejecutora debe coincidir con la asociación loggeada (si hay varias, no permitir)
- Asociación acreditada
- Tracto disponible
- Montos correctos

*** Respuesta

#+begin_src json
{
  "solicitud": {
    "id": 123
  }
}
#+end_src

** Ver solicitud

Ver los detalles de una solicitud, sus documentos adjuntos, etc.

*** Endpoint

#+begin_src
/api/solicitud/[ID]
#+end_src

*** Permisos

- La asociación ejecutora de la solicitud ID debe coincidir con la asociación loggeada

*** Respuesta

** Ver usuario

*** Endpoint

#+begin_src
/api/usuario/[ID Usuario]
#+end_src

*** Permisos

- El ID de la asociación debe coincidir con la asociación loggeada

*** Respuesta

#+begin_src json
{
  "usuario": {
    "nombre": "Secretaria de Finanzas",
    "acreditacion": {
      "teeu": "true",
      "coes": "false"
    }
  }
}
#+end_src

** Ver cuentas del usuario

*** Endpoint

#+begin_src
/api/cuentas/[ID Cuenta]
#+end_src

*** Permisos

- El ID de la asociación debe coincidir con la asociación loggeada

*** Respuesta

#+begin_src json
{
  "servicios": {
    "items": [
      {
        "id": 123,
        "detalle": "value",
        "proveedor": "value",
        "monto": "value"
      },
      {
        "id": 1234,
        "detalle": "value",
        "proveedor": "value",
        "monto": "value"
      }
    ],
    "restante": "value"
  },
  "suministros": {
    "items": [
      {
        "detalle": "value",
        "monto": "value"
      }
    ],
    "restante": "value"
  },
  "bienes": {
    "items": [
      {
        "id": 123,
        "detalle": "value",
        "proveedor": "value",
        "monto": "value"
      },
      {
        "id": 1234,
        "detalle": "value",
        "proveedor": "value",
        "monto": "value"
      }
    ],
    "restante": "value"
  }
}
#+end_src
