<main>
  <h1>{{.Cuenta.Nombre}}</h1>
  <span>Acreditaciones:</span>
  <div style="background-color: {{if .Cuenta.TEEU}}seagreen{{end}}" class="tag {{if .Cuenta.TEEU}}active{{end}}">TEEU</div>
  <div style="background-color: {{if .Cuenta.COES}}seagreen{{end}}" class="tag {{if .Cuenta.COES}}active{{end}}">COES</div>
  <div class="tooltip">
    <i class='bx bxs-info-circle' ></i>
    <div class="tooltip-text">
      Se necesitan estas acreditaciones para ejecutar presupuesto.
    </div>
  </div>
  <br><br><hr>
  <div class="scrollable">
    {{if .Cuenta.PGeneral}}
    <div class="item">
      <div class="card">
        <div class="card-header">
          <span class="card-title">{{.Periodo}}</span>
        </div>
        <!-- General -->
        <div class="card-item">
          <div class="progress-bar">
            <div class="progress" style="width: {{frac (calcularRestante "PGeneral") .Cuenta.PGeneral}}%;"></div>
          </div>
          <span class="label">General</span>
          <span class="value">{{currency (calcularRestante "PGeneral")}} / {{currency .Cuenta.PGeneral}}</span>
        </div>
      </div>
    </div>
    {{else}}
    <!-- P1 -->
    <div class="item">
      <div class="card">
        <div class="card-header">
          <span class="card-title">{{.Periodo}}-1</span>
          <span class="card-subtitle">{{currency (calcularRestante "P1Total")}} / {{currency .Cuenta.P1Total}}</span>
        </div>
        <!-- Servicios -->
        <div class="card-item">
          <div class="progress-bar">
            <div class="progress" style="width: {{frac (calcularRestante "P1Servicios") .Cuenta.P1Servicios}}%;"></div>
          </div>
          <span class="label">Servicios</span>
          <span class="value">{{currency (calcularRestante "P1Servicios")}} / {{currency .Cuenta.P1Servicios}}</span>
        </div>
        <!-- Suministros -->
        <div class="card-item">
          <div class="progress-bar">
            <div class="progress" style="width: {{frac (calcularRestante "P1Suministros") .Cuenta.P1Suministros}}%;"></div>
          </div>
          <span class="label">Suministros</span>
          <span class="value">{{currency (calcularRestante "P1Suministros")}} / {{currency .Cuenta.P1Suministros}}</span>
        </div>
        <!-- Bienes -->
        <div class="card-item">
          <div class="progress-bar">
            <div class="progress" style="width: {{frac (calcularRestante "P1Bienes") .Cuenta.P1Bienes}}%;"></div>
          </div>
          <span class="label">Bienes</span>
          <span class="value">{{currency (calcularRestante "P1Bienes")}} / {{currency .Cuenta.P1Bienes}}</span>
        </div>
      </div>
    </div>
    <!-- P2 -->
    <div class="item">
      <div class="card">
        <div class="card-header">
          <span class="card-title">{{.Periodo}}-2</span>
          <span class="card-subtitle">{{currency (calcularRestante "P2Total")}} / {{currency .Cuenta.P2Total}}</span>
        </div>
        <!-- Servicios -->
        <div class="card-item">
          <div class="progress-bar">
            <div class="progress" style="width: {{frac (calcularRestante "P2Servicios") .Cuenta.P2Servicios}}%;"></div>
          </div>
          <span class="label">Servicios</span>
          <span class="value">{{currency (calcularRestante "P2Servicios")}} / {{currency .Cuenta.P2Servicios}}</span>
        </div>
        <!-- Suministros -->
        <div class="card-item">
          <div class="progress-bar">
            <div class="progress" style="width: {{frac (calcularRestante "P2Suministros") .Cuenta.P2Suministros}}%;"></div>
          </div>
          <span class="label">Suministros</span>
          <span class="value">{{currency (calcularRestante "P2Suministros")}} / {{currency .Cuenta.P2Suministros}}</span>
        </div>
        <!-- Bienes -->
        <div class="card-item">
          <div class="progress-bar">
            <div class="progress" style="width: {{frac (calcularRestante "P2Bienes") .Cuenta.P2Bienes}}%;"></div>
          </div>
          <span class="label">Bienes</span>
          <span class="value">{{currency (calcularRestante "P2Bienes")}} / {{currency .Cuenta.P2Bienes}}</span>
        </div>
      </div>
    </div>
    {{end}}
  </div>
  <div class="scrollable">
    <div class="item">
      <!-- Servicios -->
      <div class="card">
        <div class="card-header">
          <span class="card-title">Servicios</span>
          <a href="#">
            <i style="font-size: 1.5em" class='bx bxs-edit' ></i>
          </a>
        </div>
        <div class="card-items">
          {{ range .Servicios }}
          <hr>
          <div class="card-item"
            hx-get="/api/servicios/{{.IDServicios}}"
            hx-target="#dialog-content"
            hx-swap="innerHTML"
            onclick="showDialog()">
            <div style="background-color: goldenrod" class="tag active">Firmado</div>
            <div style="background-color: {{if .GecoSol}}cornflowerblue{{end}}" class="tag {{if .GecoSol}}active{{end}}">SF</div>
            <div style="background-color: {{if .COES}}peru{{end}}" class="tag {{if .COES}}active{{end}}">COES</div>
            <div style="background-color: {{if .Ejecutado}}seagreen{{end}}" class="tag {{if .Ejecutado}}active{{end}}">Ejecutado</div>
            <br>
            <span class="label">{{.Detalle}}</span>
            <span class="label">{{.ProvNom}}</span>
            <br>
            <span class="value">-{{currency .MontoBruto}}</span>
          </div>
          {{ end }}
        </div>
      </div>
    </div>
    <div class="item">
      <!-- Suministros -->
      <div class="card">
        <div class="card-header">
          <span class="card-title">Suministros</span>
          <a href="#">
            <i style="font-size: 1.5em" class='bx bxs-edit' ></i>
          </a>
        </div>
        <div class="card-items">
          {{range .Suministros}}
          <hr>
          <div class="card-item"
            hx-get="/api/suministros/{{.IDSuministros}}"
            hx-target="#dialog-content"
            hx-swap="innerHTML"
            onclick="showDialog()">
            <div style="background-color: goldenrod" class="tag active">Firmado</div>
            <div style="background-color: {{if .Geco}}cornflowerblue{{end}}" class="tag {{if .Geco}}active{{end}}">SF</div>
            <div style="background-color: {{if .COES}}peru{{end}}" class="tag {{if .COES}}active{{end}}">COES</div>
            <br>
            <span class="label">Solicitud de suministros No.{{.IDSuministros}}</span>
            <br>
            <span class="value">-{{currency .MontoBrutoTotal}}</span>
          </div>
          {{end}}
        </div>
      </div>
    </div>
    <div class="item">
      <!-- Bienes -->
      <div class="card">
        <div class="card-header">
          <span class="card-title">Bienes</span>
          <a href="#">
            <i style="font-size: 1.5em" class='bx bxs-edit' ></i>
          </a>
        </div>
        <div class="card-items">
          {{range .Bienes}}
          <hr>
          <div class="card-item"
            hx-get="/api/bienes/{{.IDBienes}}"
            hx-target="#dialog-content"
            hx-swap="innerHTML"
            onclick="showDialog()">
            <div style="background-color: goldenrod" class="tag active">Firmado</div>
            <div style="background-color: {{if .GecoSol}}cornflowerblue{{end}}" class="tag {{if .GecoSol}}active{{end}}">SF</div>
            <div style="background-color: {{if .COES}}peru{{end}}" class="tag {{if .COES}}active{{end}}">COES</div>
            <div style="background-color: {{if .Recibido}}seagreen{{end}}" class="tag {{if .Recibido}}active{{end}}">Recibido</div>
            <br>
            <span class="label">{{.Detalle}}</span>
            <br>
            <span class="value">-{{currency .MontoBruto}}</span>
          </div>
          {{end}}
        </div>
      </div>
    </div>
  </div>
  <div class="scrollable">
    <div class="item">
      <!-- Donaciones -->
      <div class="card">
        <div class="card-header">
          <span class="card-title">Donaciones</span>
          <a href="#">
            <i style="font-size: 1.5em" class='bx bxs-edit' ></i>
          </a>
        </div>
        <div class="card-items">
          {{ $parentIDCuenta := .Cuenta.IDCuenta }}
          {{ range .Donaciones }}
          <hr>
          <div class="card-item"
            hx-get="/api/donaciones/{{.IDDonacion}}"
            hx-target="#dialog-content"
            hx-swap="innerHTML"
            onclick="showDialog()">
            <div style="background-color: goldenrod" class="tag active">Firmado</div>
            <br>
            <span class="label">{{.Detalle}}</span>
            <br>
            <span class="value">
              {{if eq .IDCuentaEntrada $parentIDCuenta}}
                {{if eq .PartidaEntrada "servicios"}}Servicios{{end}}
                {{if eq .PartidaEntrada "suministros"}}Suministros{{end}}
                {{if eq .PartidaEntrada "bienes"}}Bienes{{end}}
                {{if eq .PartidaEntrada "Donation In A2"}}Bienes{{end}}<!-- TESTING -->
              {{end}}
              {{if eq .IDCuentaSalida $parentIDCuenta}}
                {{if eq .PartidaSalida "servicios"}}Servicios{{end}}
                {{if eq .PartidaSalida "suministros"}}Suministros{{end}}
                {{if eq .PartidaSalida "bienes"}}Bienes{{end}}
                {{if eq .PartidaSalida "Donation Out A1"}}Bienes{{end}}<!-- TESTING -->
              {{end}}
              / {{if eq .IDCuentaSalida $parentIDCuenta}}-{{else}}+{{end}}{{currency .MontoBruto}}
            </span>
          </div>
          {{ end }}
        </div>
      </div>
    </div>
    <div class="item">
      <!-- Ajustes -->
      <div class="card">
        <div class="card-header">
          <span class="card-title">Ajustes</span>
          <a href="#">
            <i style="font-size: 1.5em" class='bx bxs-edit' ></i>
          </a>
        </div>
        <div class="card-items">
          {{range .Ajustes}}
          <hr>
          <div class="card-item"
            hx-get="/api/ajustes/{{.IDAjustes}}"
            hx-target="#dialog-content"
            hx-swap="innerHTML"
            onclick="showDialog()">
            <span class="label">{{.Detalle}}</span>
            <br>
            <span class="value">
              {{if eq .Partida "servicios"}}Servicios{{end}}
              {{if eq .Partida "suministros"}}Suministros{{end}}
              {{if eq .Partida "bienes"}}Bienes{{end}}
              {{if eq .Partida "Partida A1"}}Bienes{{end}}<!-- TESTING -->
              / {{if gt .MontoBruto 0.00}}+{{end}}{{currency .MontoBruto}}
            </span>
          </div>
          {{end}}
        </div>
      </div>
    </div>
  </div>
</main>
